package ru.nsu.fit.oop.maximov.primenumbers;

import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.Arguments;
import org.junit.jupiter.params.provider.MethodSource;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import java.util.concurrent.atomic.AtomicBoolean;
import java.util.stream.Stream;

import static java.util.Collections.max;
import static org.assertj.core.api.AssertionsForClassTypes.assertThat;

public class PrimeTest {
    private static Double sequentialSolAvgTime = 0.0;
    private static List<Double> threadSolAvgTime;
    private static Double threadSolTotalAvgTime = 0.0;
    private static Double parallelStreamSolAvgTime = 0.0;
    private static final Long num = 1L; //testsProvider().count();
    private static int MAX_THREADS;

    @BeforeAll
    static void init() {
        MAX_THREADS = Runtime.getRuntime().availableProcessors();
        threadSolAvgTime = new ArrayList<>(Collections.nCopies(MAX_THREADS, 0.0));
    }

    private Long sequentialSol(List<Integer> list, boolean answer) {
        var time0 = System.currentTimeMillis();

        var result = false;
        for (var num : list) {
            if (Prime.isComposite(num)) {
                result = true;
                break;
            }
        }

        var time = System.currentTimeMillis();
        return result == answer ? time - time0 : null;
    }
    private List<Long> threadSol(List<Integer> list, boolean answer) {
        var times = new ArrayList<>(Collections.nCopies(MAX_THREADS, 0L));
        var result = new AtomicBoolean();
        var threads = new ArrayList<Thread>();

        var step = Math.max(MAX_THREADS,
                list.size() / (MAX_THREADS - (list.size() % MAX_THREADS == 0 ? 0 : 1)));

        for (var i = 0; i < list.size(); i += step){
            var idx = i;

            var thread = new Thread() {
                @Override
                public void run() {
                    var time0 = System.currentTimeMillis();

                    for (var num : list.subList(idx, idx + Math.min(list.size() - idx, step) - 1)) {
                        if (isInterrupted()) {
                            break;
                        }
                        if (Prime.isComposite(num)) {
                            result.set(true);
                            break;
                        }
                    }

                    var time = System.currentTimeMillis();
                    times.add(time - time0);
                }
            };
            thread.start();
            threads.add(thread);
        }

        for (var thread : threads) {
            if (result.get()) {
                threads.forEach(Thread::interrupt);
                break;
            }
            try {
                thread.join();
            } catch (InterruptedException ignored) {}
        }

        return result.get() == answer ? times : null;
    }
    private static Long parallelStreamSol(List<Integer> list, boolean answer) {
        var time0 = System.currentTimeMillis();

        var result = list
                .parallelStream()
                .anyMatch(Prime::isComposite);

        var time = System.currentTimeMillis();
        return result == answer ? time - time0 : null;
    }

    private static Double timeToAvgFraction(Long time) {
        assertThat(time).isNotNull();
        return time.doubleValue() / num.doubleValue();
    }

    private static Stream<Arguments> testsProvider() {
        return Stream.of(
                // is this a test?.. (from example, has composite)
                Arguments.of(
                        Arrays.asList(6, 8, 7, 13, 9, 4),
                        true
                ),
                // just big prime numbers from examples
                Arguments.of(
                        Arrays.asList(6997901, 6997927, 6997937, 6997967, 6998009, 6998029, 6998039, 6998051, 6998053, 6997901, 6997927, 6997937, 6997967, 6998009, 6998029, 6998039, 6998051),
                        false
                ),
                // first 1000 prime numbers
                Arguments.of(
                        Arrays.asList(2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419, 421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599, 601, 607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701, 709, 719, 727, 733, 739, 743, 751, 757, 761, 769, 773, 787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857, 859, 863, 877, 881, 883, 887, 907, 911, 919, 929, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997, 1009, 1013, 1019, 1021, 1031, 1033, 1039, 1049, 1051, 1061, 1063, 1069, 1087, 1091, 1093, 1097, 1103, 1109, 1117, 1123, 1129, 1151, 1153, 1163, 1171, 1181, 1187, 1193, 1201, 1213, 1217, 1223, 1229, 1231, 1237, 1249, 1259, 1277, 1279, 1283, 1289, 1291, 1297, 1301, 1303, 1307, 1319, 1321, 1327, 1361, 1367, 1373, 1381, 1399, 1409, 1423, 1427, 1429, 1433, 1439, 1447, 1451, 1453, 1459, 1471, 1481, 1483, 1487, 1489, 1493, 1499, 1511, 1523, 1531, 1543, 1549, 1553, 1559, 1567, 1571, 1579, 1583, 1597, 1601, 1607, 1609, 1613, 1619, 1621, 1627, 1637, 1657, 1663, 1667, 1669, 1693, 1697, 1699, 1709, 1721, 1723, 1733, 1741, 1747, 1753, 1759, 1777, 1783, 1787, 1789, 1801, 1811, 1823, 1831, 1847, 1861, 1867, 1871, 1873, 1877, 1879, 1889, 1901, 1907, 1913, 1931, 1933, 1949, 1951, 1973, 1979, 1987, 1993, 1997, 1999, 2003, 2011, 2017, 2027, 2029, 2039, 2053, 2063, 2069, 2081, 2083, 2087, 2089, 2099, 2111, 2113, 2129, 2131, 2137, 2141, 2143, 2153, 2161, 2179, 2203, 2207, 2213, 2221, 2237, 2239, 2243, 2251, 2267, 2269, 2273, 2281, 2287, 2293, 2297, 2309, 2311, 2333, 2339, 2341, 2347, 2351, 2357, 2371, 2377, 2381, 2383, 2389, 2393, 2399, 2411, 2417, 2423, 2437, 2441, 2447, 2459, 2467, 2473, 2477, 2503, 2521, 2531, 2539, 2543, 2549, 2551, 2557, 2579, 2591, 2593, 2609, 2617, 2621, 2633, 2647, 2657, 2659, 2663, 2671, 2677, 2683, 2687, 2689, 2693, 2699, 2707, 2711, 2713, 2719, 2729, 2731, 2741, 2749, 2753, 2767, 2777, 2789, 2791, 2797, 2801, 2803, 2819, 2833, 2837, 2843, 2851, 2857, 2861, 2879, 2887, 2897, 2903, 2909, 2917, 2927, 2939, 2953, 2957, 2963, 2969, 2971, 2999, 3001, 3011, 3019, 3023, 3037, 3041, 3049, 3061, 3067, 3079, 3083, 3089, 3109, 3119, 3121, 3137, 3163, 3167, 3169, 3181, 3187, 3191, 3203, 3209, 3217, 3221, 3229, 3251, 3253, 3257, 3259, 3271, 3299, 3301, 3307, 3313, 3319, 3323, 3329, 3331, 3343, 3347, 3359, 3361, 3371, 3373, 3389, 3391, 3407, 3413, 3433, 3449, 3457, 3461, 3463, 3467, 3469, 3491, 3499, 3511, 3517, 3527, 3529, 3533, 3539, 3541, 3547, 3557, 3559, 3571, 3581, 3583, 3593, 3607, 3613, 3617, 3623, 3631, 3637, 3643, 3659, 3671, 3673, 3677, 3691, 3697, 3701, 3709, 3719, 3727, 3733, 3739, 3761, 3767, 3769, 3779, 3793, 3797, 3803, 3821, 3823, 3833, 3847, 3851, 3853, 3863, 3877, 3881, 3889, 3907, 3911, 3917, 3919, 3923, 3929, 3931, 3943, 3947, 3967, 3989, 4001, 4003, 4007, 4013, 4019, 4021, 4027, 4049, 4051, 4057, 4073, 4079, 4091, 4093, 4099, 4111, 4127, 4129, 4133, 4139, 4153, 4157, 4159, 4177, 4201, 4211, 4217, 4219, 4229, 4231, 4241, 4243, 4253, 4259, 4261, 4271, 4273, 4283, 4289, 4297, 4327, 4337, 4339, 4349, 4357, 4363, 4373, 4391, 4397, 4409, 4421, 4423, 4441, 4447, 4451, 4457, 4463, 4481, 4483, 4493, 4507, 4513, 4517, 4519, 4523, 4547, 4549, 4561, 4567, 4583, 4591, 4597, 4603, 4621, 4637, 4639, 4643, 4649, 4651, 4657, 4663, 4673, 4679, 4691, 4703, 4721, 4723, 4729, 4733, 4751, 4759, 4783, 4787, 4789, 4793, 4799, 4801, 4813, 4817, 4831, 4861, 4871, 4877, 4889, 4903, 4909, 4919, 4931, 4933, 4937, 4943, 4951, 4957, 4967, 4969, 4973, 4987, 4993, 4999, 5003, 5009, 5011, 5021, 5023, 5039, 5051, 5059, 5077, 5081, 5087, 5099, 5101, 5107, 5113, 5119, 5147, 5153, 5167, 5171, 5179, 5189, 5197, 5209, 5227, 5231, 5233, 5237, 5261, 5273, 5279, 5281, 5297, 5303, 5309, 5323, 5333, 5347, 5351, 5381, 5387, 5393, 5399, 5407, 5413, 5417, 5419, 5431, 5437, 5441, 5443, 5449, 5471, 5477, 5479, 5483, 5501, 5503, 5507, 5519, 5521, 5527, 5531, 5557, 5563, 5569, 5573, 5581, 5591, 5623, 5639, 5641, 5647, 5651, 5653, 5657, 5659, 5669, 5683, 5689, 5693, 5701, 5711, 5717, 5737, 5741, 5743, 5749, 5779, 5783, 5791, 5801, 5807, 5813, 5821, 5827, 5839, 5843, 5849, 5851, 5857, 5861, 5867, 5869, 5879, 5881, 5897, 5903, 5923, 5927, 5939, 5953, 5981, 5987, 6007, 6011, 6029, 6037, 6043, 6047, 6053, 6067, 6073, 6079, 6089, 6091, 6101, 6113, 6121, 6131, 6133, 6143, 6151, 6163, 6173, 6197, 6199, 6203, 6211, 6217, 6221, 6229, 6247, 6257, 6263, 6269, 6271, 6277, 6287, 6299, 6301, 6311, 6317, 6323, 6329, 6337, 6343, 6353, 6359, 6361, 6367, 6373, 6379, 6389, 6397, 6421, 6427, 6449, 6451, 6469, 6473, 6481, 6491, 6521, 6529, 6547, 6551, 6553, 6563, 6569, 6571, 6577, 6581, 6599, 6607, 6619, 6637, 6653, 6659, 6661, 6673, 6679, 6689, 6691, 6701, 6703, 6709, 6719, 6733, 6737, 6761, 6763, 6779, 6781, 6791, 6793, 6803, 6823, 6827, 6829, 6833, 6841, 6857, 6863, 6869, 6871, 6883, 6899, 6907, 6911, 6917, 6947, 6949, 6959, 6961, 6967, 6971, 6977, 6983, 6991, 6997, 7001, 7013, 7019, 7027, 7039, 7043, 7057, 7069, 7079, 7103, 7109, 7121, 7127, 7129, 7151, 7159, 7177, 7187, 7193, 7207, 7211, 7213, 7219, 7229, 7237, 7243, 7247, 7253, 7283, 7297, 7307, 7309, 7321, 7331, 7333, 7349, 7351, 7369, 7393, 7411, 7417, 7433, 7451, 7457, 7459, 7477, 7481, 7487, 7489, 7499, 7507, 7517, 7523, 7529, 7537, 7541, 7547, 7549, 7559, 7561, 7573, 7577, 7583, 7589, 7591, 7603, 7607, 7621, 7639, 7643, 7649, 7669, 7673, 7681, 7687, 7691, 7699, 7703, 7717, 7723, 7727, 7741, 7753, 7757, 7759, 7789, 7793, 7817, 7823, 7829, 7841, 7853, 7867, 7873, 7877, 7879, 7883, 7901, 7907, 7919),
                        false
                ),
                // a lot of big prime numbers
                Arguments.of(
                        Arrays.asList(1006739, 1006751, 1006769, 1006781, 1006783, 1006799, 1006847, 1006853, 1006861, 1006877, 1006879, 1006883, 1006891, 1006897, 1006933, 1006937, 1006949, 1006969, 1006979, 1006987, 1006991, 1007021, 1007023, 1007047, 1007059, 1007081, 1007089, 1007099, 1007117, 1007119, 1007129, 1007137, 1007161, 1007173, 1007179, 1007203, 1007231, 1007243, 1007249, 1007297, 1007299, 1007309, 1007317, 1007339, 1007353, 1007359, 1007381, 1007387, 1007401, 1007417, 1007429, 1007441, 1007459, 1007467, 1007483, 1007497, 1007519, 1007527, 1007549, 1007557, 1007597, 1007599, 1007609, 1007647, 1007651, 1007681, 1007683, 1007693, 1007701, 1007711, 1007719, 1007723, 1007729, 1007731, 1007749, 1007753, 1007759, 1007767, 1007771, 1007789, 1007801, 1007807, 1007813, 1007819, 1007827, 1007857, 1007861, 1007873, 1007887, 1007891, 1007921, 1007933, 1007939, 1007957, 1007959, 1007971, 1007977, 1008001, 1008013, 1008017, 1008031, 1008037, 1008041, 1008043, 1008101, 1008131, 1008157, 1008181, 1008187, 1008193, 1008199, 1008209, 1008223, 1008229, 1008233, 1008239, 1008247, 1008257, 1008263, 1008317, 1008323, 1008331, 1008347, 1008353, 1008373, 1008379, 1008401, 1008407, 1008409, 1008419, 1008421, 1008433, 1008437, 1008451, 1008467, 1008493, 1008499, 1008503, 1008517, 1008541, 1008547, 1008563, 1008571, 1008587, 1008589, 1008607, 1008611, 1008613, 1008617, 1008659, 1008701, 1008719, 1008743, 1008773, 1008779, 1008781, 1008793, 1008809, 1008817, 1008829, 1008851, 1008853, 1008857, 1008859, 1008863, 1008871, 1008901, 1008911, 1008913, 1008923, 1008937, 1008947, 1008979, 1008983, 1008989, 1008991, 1009007, 1009037, 1009049, 1009061, 1009097, 1009121, 1009139, 1009153, 1009157, 1009159, 1009163, 1009189, 1009193, 1009199, 1009201, 1009207, 1009237, 1009243, 1009247, 1009259, 1009289, 1009291, 1009301, 1009303, 1009319, 1009321, 1009343, 1009357, 1009361, 1009369, 1009373, 1009387, 1009399, 1009417, 1009433, 1009439, 1009457, 1009483, 1009487, 1009499, 1009501, 1009507, 1009531, 1009537, 1009559, 1009573, 1009601, 1009609, 1009621, 1009627, 1009637, 1009643, 1009649, 1009651, 1009669, 1009727, 1009741, 1009747, 1009781, 1009787, 1009807, 1009819, 1009837, 1009843, 1009859, 1009873, 1009901, 1009909, 1009927, 1009937, 1009951, 1009963, 1009991, 1009993, 1009997, 1010003, 1010033, 1010069, 1010081, 1010083, 1010129, 1010131, 1010143, 1010167, 1010179, 1010201, 1010203, 1010237, 1010263, 1010291, 1010297, 1010329, 1010353, 1010357, 1010381, 1010407, 1010411, 1010419, 1010423, 1010431, 1010461, 1010467, 1010473, 1010491, 1010501, 1010509, 1010519, 1010549, 1010567, 1010579, 1010617, 1010623, 1010627, 1010671, 1010683, 1010687, 1010717, 1010719, 1010747, 1010749, 1010753, 1010759, 1010767, 1010771, 1010783, 1010791, 1010797, 1010809, 1010833, 1010843, 1010861, 1010881, 1010897, 1010899, 1010903, 1010917, 1010929, 1010957, 1010981, 1010983, 1010993, 1011001, 1011013, 1011029, 1011037, 1011067, 1011071, 1011077, 1011079, 1011091, 1011107, 1011137, 1011139, 1011163, 1011167, 1011191, 1011217, 1011221, 1011229, 1011233, 1011239, 1011271, 1011277, 1011281, 1011289, 1011331, 1011343, 1011349, 1011359, 1011371, 1011377, 1011391, 1011397, 1011407, 1011431, 1011443, 1011509, 1011539, 1011553, 1011559, 1011583, 1011587, 1011589, 1011599, 1011601, 1011631, 1011641, 1011649, 1011667, 1011671, 1011677, 1011697, 1011719, 1011733, 1011737, 1011749, 1011763, 1011779, 1011797, 1011799, 1011817, 1011827, 1011889, 1011893, 1011917, 1011937, 1011943, 1011947, 1011961, 1011973, 1011979, 1012007, 1012009, 1012031, 1012043, 1012049, 1012079, 1012087, 1012093, 1012097, 1012103, 1012133, 1012147, 1012159, 1012171, 1012183, 1012189, 1012201, 1012213, 1012217, 1012229, 1012241, 1012259, 1012261, 1012267, 1012279, 1012289, 1012307, 1012321, 1012369, 1012373, 1012379, 1012397, 1012399, 1012411, 1012421, 1012423, 1012433, 1012439, 1012447, 1012457, 1012463, 1012481, 1012489, 1012507, 1012513, 1012519, 1012523, 1012547, 1012549, 1012559, 1012573, 1012591, 1012597, 1012601, 1012619, 1012631, 1012633, 1012637, 1012657, 1012663, 1012679, 1012691, 1012699, 1012703, 1012717, 1012721, 1012733, 1012751, 1012763, 1012769, 1012771, 1012789, 1012811, 1012829, 1012831, 1012861, 1012903, 1012919, 1012931, 1012967, 1012981, 1012993, 1012997, 1013003, 1013009, 1013029, 1013041, 1013053, 1013063, 1013143, 1013153, 1013197, 1013203, 1013227, 1013237, 1013239, 1013249, 1013263, 1013267, 1013279, 1013291, 1013321, 1013329, 1013377, 1013399, 1013401, 1013429, 1013431, 1013471, 1013477, 1013501, 1013503, 1013527, 1013531, 1013533, 1013563, 1013569, 1013581, 1013603, 1013609, 1013627, 1013629, 1013641, 1013671, 1013681, 1013687, 1013699, 1013711, 1013713, 1013717, 1013729, 1013741, 1013767, 1013773, 1013791, 1013813, 1013819, 1013827, 1013833, 1013839, 1013843, 1013851, 1013879, 1013891, 1013893, 1013899, 1013921, 1013923, 1013933, 1013993, 1014007, 1014029, 1014037, 1014061, 1014089, 1014113, 1014121, 1014127, 1014131, 1014137, 1014149, 1014157, 1014161, 1014173, 1014193, 1014197, 1014199, 1014229, 1014257, 1014259, 1014263, 1014287, 1014301, 1014317, 1014319, 1014331, 1014337, 1014341, 1014359, 1014361, 1014371, 1014389, 1014397, 1014451, 1014457, 1014469, 1014487, 1014493, 1014521, 1014539, 1014547, 1014557, 1014571, 1014593, 1014617, 1014631, 1014641, 1014649, 1014677, 1014697, 1014719, 1014721, 1014731, 1014743, 1014749, 1014763, 1014779, 1014787, 1014817, 1014821, 1014833, 1014863, 1014869, 1014877, 1014887, 1014889, 1014907, 1014941, 1014953, 1014973, 1014989, 1015009, 1015039, 1015043, 1015051, 1015057, 1015061, 1015067, 1015073, 1015081, 1015093, 1015097, 1015123, 1015127, 1015139, 1015159, 1015163, 1015171, 1015199, 1015207, 1015277, 1015309, 1015349, 1015361, 1015363, 1015367, 1015369, 1015403, 1015409, 1015423, 1015433, 1015451, 1015453, 1015459, 1015463, 1015471, 1015481, 1015499, 1015501, 1015507, 1015517, 1015523, 1015541, 1015549, 1015559, 1015561, 1015571, 1015601, 1015603, 1015627, 1015661, 1015691, 1015697, 1015709, 1015723, 1015727, 1015739, 1015747, 1015753, 1015769, 1015813, 1015823, 1015829, 1015843, 1015853, 1015871, 1015877, 1015891, 1015897, 1015907, 1015913, 1015919, 1015967, 1015981, 1015991, 1016009, 1016011, 1016023, 1016027, 1016033, 1016051, 1016053, 1016069, 1016083, 1016089, 1016111, 1016123, 1016137, 1016143, 1016153, 1016159, 1016173, 1016201, 1016203, 1016221, 1016227, 1016231, 1016237, 1016263, 1016303, 1016339, 1016341, 1016357, 1016359, 1016371, 1016399, 1016401, 1016419, 1016423, 1016441, 1016453, 1016489, 1016497, 1016527, 1016567, 1016569, 1016573, 1016581, 1016597, 1016599, 1016611, 1016621, 1016641, 1016663, 1016681, 1016689, 1016731, 1016737, 1016749, 1016773, 1016777, 1016783, 1016789, 1016839, 1016843, 1016849, 1016879, 1016881, 1016891, 1016909, 1016921, 1016927, 1016929, 1016941, 1016947, 1016959, 1016971, 1017007, 1017011, 1017031, 1017041, 1017043, 1017061, 1017077, 1017097, 1017119, 1017131, 1017139, 1017157, 1017173, 1017179, 1017193, 1017199, 1017209, 1017227, 1017277, 1017293, 1017299, 1017301, 1017307, 1017311, 1017319, 1017323, 1017329, 1017347, 1017353, 1017361, 1017371, 1017377, 1017383, 1017391, 1017437, 1017439, 1017449, 1017473, 1017479, 1017481, 1017539, 1017551, 1017553, 1017559, 1017607, 1017613, 1017617, 1017623, 1017647, 1017649, 1017673, 1017683, 1017703, 1017713, 1017719, 1017721, 1017749, 1017781, 1017787, 1017799, 1017817, 1017827, 1017847, 1017851, 1017857, 1017859, 1017881, 1017889, 1017923, 1017953, 1017959, 1017997, 1018007, 1018019, 1018021, 1018057, 1018091, 1018097, 1018109, 1018123, 1018177, 1018201, 1018207, 1018217, 1018223, 1018247, 1018253, 1018271, 1018291, 1018301, 1018309, 1018313, 1018337, 1018357, 1018411, 1018421, 1018429, 1018439, 1018447, 1018471, 1018477, 1018489, 1018513, 1018543, 1018559, 1018583, 1018613, 1018621, 1018643, 1018649, 1018651, 1018669, 1018673, 1018679, 1018697, 1018709, 1018711, 1018729, 1018733, 1018763, 1018769, 1018777, 1018789, 1018807, 1018811, 1018813, 1018817, 1018859, 1018873, 1018879, 1018889, 1018903, 1018907, 1018931, 1018937, 1018949, 1018957, 1018967, 1018981, 1018987, 1018993, 1018999, 1019023, 1019033, 1019059, 1019069, 1019071, 1019077, 1019093, 1019119, 1019129, 1019173, 1019177, 1019197, 1019209, 1019237, 1019251, 1019257, 1019261, 1019267, 1019273, 1019281, 1019297, 1019329, 1019339, 1019351, 1019353, 1019357, 1019377, 1019399, 1019411, 1019413, 1019423, 1019443, 1019449, 1019453, 1019467, 1019471, 1019479, 1019503, 1019509, 1019531, 1019533, 1019537, 1019549, 1019563, 1019617, 1019639, 1019647, 1019657, 1019663, 1019687, 1019693, 1019699, 1019701, 1019713, 1019717, 1019723, 1019729, 1019731, 1019741, 1019747, 1019771, 1019783, 1019801, 1019819, 1019827, 1019839, 1019849, 1019857, 1019861, 1019873, 1019899, 1019903, 1019927, 1019971, 1020001, 1020007, 1020011, 1020013, 1020023, 1020037, 1020043, 1020049, 1020059, 1020077, 1020079, 1020101, 1020109, 1020113, 1020137, 1020143, 1020157, 1020163, 1020223, 1020233, 1020247, 1020259, 1020269, 1020293, 1020301, 1020329, 1020337, 1020353, 1020361, 1020379, 1020389, 1020401, 1020407, 1020413, 1020419, 1020431, 1020451, 1020457, 1020491, 1020517, 1020529, 1020541, 1020557, 1020583, 1020589, 1020599, 1020619, 1020631, 1020667, 1020683, 1020689, 1020707, 1020709, 1020743, 1020751, 1020757, 1020779, 1020797, 1020821, 1020823, 1020827, 1020839, 1020841, 1020847, 1020853, 1020881, 1020893, 1020907, 1020913, 1020931, 1020959, 1020961, 1020967, 1020973, 1020977, 1020979, 1020989, 1020991, 1020997, 1021001, 1021019, 1021043, 1021067, 1021073, 1021081, 1021087, 1021091, 1021093, 1021123, 1021127, 1021129, 1021157, 1021159, 1021183, 1021199, 1021217, 1021243, 1021253, 1021259, 1021261, 1021271, 1021283, 1021289, 1021291, 1021297, 1021301, 1021303, 1021327, 1021331, 1021333, 1021367, 1021369, 1021373, 1021381, 1021387, 1021403, 1021417, 1021429, 1021441, 1021457, 1021463, 1021483, 1021487, 1021541, 1021561, 1021571, 1021577, 1021621, 1021627, 1021651, 1021661, 1021663, 1021673, 1021697, 1021711, 1021747, 1021753, 1021759, 1021777, 1021793, 1021799, 1021807, 1021831, 1021837, 1021849, 1021861, 1021879, 1021897, 1021907, 1021919, 1021961, 1021963, 1021973, 1022011, 1022017, 1022033, 1022053, 1022059, 1022071, 1022083, 1022113, 1022123, 1022129, 1022137, 1022141, 1022167, 1022179, 1022183, 1022191, 1022201, 1022209, 1022237, 1022243, 1022249, 1022251, 1022291, 1022303, 1022341, 1022377, 1022381, 1022383, 1022387, 1022389, 1022429, 1022443, 1022449, 1022467, 1022491, 1022501, 1022503, 1022507, 1022509, 1022513, 1022519, 1022531, 1022573, 1022591, 1022611, 1022629, 1022633, 1022639, 1022653, 1022677, 1022683, 1022689, 1022701, 1022719, 1022729, 1022761, 1022773, 1022797, 1022821, 1022837, 1022843, 1022849, 1022869, 1022881, 1022891, 1022899, 1022911, 1022929, 1022933, 1022963, 1022977, 1022981, 1023019, 1023037, 1023041, 1023047, 1023067, 1023079, 1023083, 1023101, 1023107, 1023133, 1023163, 1023167, 1023173, 1023199, 1023203, 1023221, 1023227, 1023229, 1023257, 1023259, 1023263, 1023277, 1023289, 1023299, 1023301, 1023311, 1023313, 1023317, 1023329, 1023353, 1023361, 1023367, 1023389, 1023391, 1023409, 1023413, 1023419, 1023461, 1023467, 1023487, 1023499, 1023521, 1023541, 1023551, 1023557, 1023571, 1023577, 1023601, 1023643, 1023653, 1023697, 1023719, 1023721, 1023731, 1023733, 1023751, 1023769, 1023821, 1023833, 1023839, 1023851, 1023857, 1023871, 1023941, 1023943, 1023947, 1023949, 1023973, 1023977, 1023991, 1024021, 1024031, 1024061, 1024073, 1024087, 1024091, 1024099, 1024103, 1024151, 1024159, 1024171, 1024183, 1024189, 1024207, 1024249, 1024277, 1024307, 1024313, 1024319, 1024321, 1024327, 1024337, 1024339, 1024357, 1024379, 1024391, 1024399, 1024411, 1024421, 1024427, 1024433, 1024477, 1024481, 1024511, 1024523, 1024547, 1024559, 1024577, 1024579, 1024589, 1024591, 1024609, 1024633, 1024663, 1024669, 1024693, 1024697, 1024703, 1024711, 1024721, 1024729, 1024757, 1024783, 1024799, 1024823, 1024843, 1024853, 1024871, 1024883, 1024901, 1024909, 1024921, 1024931, 1024939, 1024943, 1024951, 1024957, 1024963, 1024987, 1024997, 1025009, 1025021, 1025029, 1025039, 1025047, 1025081, 1025093, 1025099, 1025111, 1025113, 1025119, 1025137, 1025147, 1025149, 1025153, 1025161, 1025197, 1025203, 1025209, 1025231, 1025239, 1025257, 1025261, 1025267, 1025273, 1025279, 1025281, 1025303, 1025327, 1025333, 1025347, 1025351, 1025383, 1025393, 1025407, 1025413, 1025417, 1025419, 1025443, 1025459, 1025477, 1025483, 1025503, 1025509, 1025513, 1025537, 1025543, 1025551, 1025561, 1025579, 1025611, 1025621, 1025623, 1025641, 1025653, 1025659, 1025669, 1025693, 1025707, 1025741, 1025747, 1025749, 1025767, 1025789, 1025803, 1025807, 1025819, 1025839, 1025873, 1025887, 1025891, 1025897, 1025909, 1025911, 1025917, 1025929, 1025939, 1025957, 1026029, 1026031, 1026037, 1026041, 1026043, 1026061, 1026073, 1026101, 1026119, 1026127, 1026139, 1026143, 1026167, 1026197, 1026199, 1026217, 1026227, 1026229, 1026251, 1026253, 1026257, 1026293, 1026299, 1026313, 1026331, 1026359, 1026371, 1026383, 1026391, 1026401, 1026407, 1026413, 1026427, 1026439, 1026449, 1026457, 1026479, 1026481, 1026521, 1026547, 1026563, 1026577, 1026581, 1026583, 1026587, 1026593, 1026661, 1026667, 1026673, 1026677, 1026679, 1026709, 1026733, 1026757, 1026761, 1026791, 1026799, 1026811, 1026829, 1026833, 1026847, 1026853, 1026859, 1026887, 1026899, 1026911, 1026913, 1026917, 1026941, 1026943, 1026947, 1026979, 1026989, 1027001, 1027003, 1027027, 1027031, 1027051, 1027067, 1027097, 1027127, 1027129, 1027139, 1027153, 1027163, 1027181, 1027189, 1027199, 1027207, 1027211, 1027223, 1027241, 1027261, 1027277, 1027289, 1027319, 1027321, 1027331, 1027357, 1027391, 1027409, 1027417, 1027421, 1027427, 1027459, 1027471, 1027483, 1027487, 1027489, 1027493, 1027519, 1027547, 1027549, 1027567, 1027591, 1027597, 1027613, 1027643, 1027679, 1027687, 1027693, 1027703, 1027717, 1027727, 1027739, 1027751, 1027753, 1027757, 1027759, 1027777, 1027783, 1027787, 1027799, 1027841, 1027853, 1027883, 1027891, 1027931, 1027969, 1027987, 1028003, 1028011, 1028017, 1028023, 1028029, 1028047, 1028051, 1028063, 1028081, 1028089, 1028099, 1028101, 1028107, 1028113, 1028117, 1028129, 1028141, 1028149, 1028189, 1028191, 1028201, 1028207, 1028213, 1028221, 1028231, 1028243, 1028263, 1028273, 1028303, 1028309, 1028317, 1028327, 1028329, 1028333, 1028389, 1028393, 1028411, 1028437, 1028471, 1028473, 1028479, 1028509, 1028557, 1028561, 1028569, 1028579, 1028581, 1028597, 1028617, 1028647, 1028663, 1028669, 1028681, 1028683, 1028737, 1028747, 1028749, 1028761, 1028773, 1028777, 1028803, 1028809, 1028837, 1028843, 1028873, 1028893, 1028903, 1028939, 1028941, 1028953, 1028957, 1028969, 1028981, 1028999, 1029001, 1029013, 1029023, 1029037, 1029103, 1029109, 1029113, 1029139, 1029151, 1029157, 1029167, 1029179, 1029191, 1029199, 1029209, 1029247, 1029251, 1029263, 1029277, 1029289, 1029307, 1029323, 1029331, 1029337, 1029341, 1029349, 1029359, 1029361, 1029383, 1029403, 1029407, 1029409, 1029433, 1029467, 1029473, 1029481, 1029487, 1029499, 1029517, 1029521, 1029527, 1029533, 1029547, 1029563, 1029569, 1029577, 1029583, 1029593, 1029601, 1029617, 1029643, 1029647, 1029653, 1029689, 1029697, 1029731, 1029751, 1029757, 1029767, 1029803, 1029823, 1029827, 1029839, 1029841, 1029859, 1029881, 1029883, 1029907, 1029929, 1029937, 1029943, 1029953, 1029967, 1029983, 1029989, 1030019, 1030021, 1030027, 1030031, 1030033, 1030039, 1030049, 1030061, 1030067, 1030069, 1030091, 1030111, 1030121, 1030153, 1030157, 1030181, 1030201, 1030213, 1030219, 1030241, 1030247, 1030291, 1030297, 1030307, 1030349, 1030357, 1030361, 1030369, 1030411, 1030417, 1030429, 1030439, 1030441, 1030451, 1030493, 1030511, 1030529, 1030537, 1030543, 1030571, 1030583, 1030619, 1030637, 1030639, 1030643, 1030681, 1030703, 1030723, 1030739, 1030741, 1030751, 1030759, 1030763, 1030787, 1030793, 1030801, 1030811, 1030817, 1030823, 1030831, 1030847, 1030867, 1030873, 1030889, 1030919, 1030933, 1030949, 1030951, 1030957, 1030987, 1030993, 1031003, 1031047, 1031053, 1031057, 1031081, 1031117, 1031119, 1031137, 1031141, 1031161, 1031189, 1031231, 1031267, 1031279, 1031281, 1031291, 1031299, 1031309, 1031323, 1031347, 1031357, 1031399, 1031411, 1031413, 1031423, 1031431, 1031447, 1031461, 1031477, 1031479, 1031483, 1031489, 1031507, 1031521, 1031531, 1031533, 1031549, 1031561, 1031593, 1031609, 1031623, 1031629, 1031633, 1031669, 1031677, 1031707, 1031717, 1031729, 1031731, 1031741, 1031753, 1031759, 1031761, 1031809, 1031813, 1031831, 1031837, 1031869, 1031911, 1031923, 1031981, 1031999, 1032007, 1032047, 1032049, 1032067, 1032071, 1032107, 1032131, 1032151, 1032191, 1032193, 1032211, 1032221, 1032233, 1032259, 1032287, 1032299, 1032307, 1032319, 1032329, 1032341, 1032347, 1032349, 1032373, 1032377, 1032391, 1032397, 1032407, 1032419, 1032433, 1032457, 1032463, 1032467, 1032491, 1032497, 1032509, 1032511, 1032527, 1032541, 1032571, 1032583, 1032601, 1032607, 1032613, 1032617, 1032643, 1032649, 1032679, 1032683, 1032697, 1032701, 1032709, 1032721, 1032727, 1032739, 1032751, 1032763, 1032793, 1032799, 1032803, 1032833, 1032839, 1032841, 1032847, 1032851, 1032853, 1032881, 1032887, 1032901, 1032943, 1032949, 1032959, 1032961, 1033001, 1033007, 1033027, 1033033, 1033037, 1033057, 1033061, 1033063, 1033069, 1033079, 1033099, 1033127, 1033139, 1033171, 1033181, 1033189, 1033223, 1033271, 1033273, 1033289, 1033297, 1033303, 1033309, 1033313, 1033337, 1033339, 1033343, 1033349, 1033363, 1033369, 1033381, 1033387, 1033393, 1033421, 1033423, 1033427, 1033441, 1033451, 1033457, 1033463, 1033469, 1033489, 1033493, 1033499, 1033507, 1033517, 1033537, 1033541, 1033559, 1033567, 1033601, 1033603, 1033631, 1033661, 1033663, 1033667, 1033679, 1033687, 1033693, 1033741, 1033751, 1033759, 1033777, 1033783, 1033789, 1033793, 1033801, 1033807, 1033829, 1033841, 1033843, 1033867, 1033927, 1033951, 1033987, 1034003, 1034009, 1034027, 1034029, 1034069, 1034071, 1034101, 1034119, 1034123, 1034147, 1034167, 1034171, 1034177, 1034183, 1034197, 1034207, 1034219, 1034221, 1034233, 1034237, 1034239, 1034249, 1034251, 1034281, 1034309, 1034317, 1034323, 1034339, 1034353, 1034357, 1034359, 1034381, 1034387, 1034419, 1034443, 1034461, 1034477, 1034479, 1034489, 1034491, 1034503, 1034513, 1034549, 1034567, 1034581, 1034591, 1034597, 1034599, 1034617, 1034639, 1034651, 1034653, 1034659, 1034707, 1034729, 1034731, 1034767, 1034771, 1034783, 1034791, 1034809, 1034827, 1034833, 1034837, 1034849, 1034857, 1034861, 1034863, 1034867, 1034879, 1034903, 1034941, 1034951, 1034953, 1034959, 1034983, 1034989, 1034993, 1035007, 1035019, 1035043, 1035061, 1035077, 1035107, 1035131, 1035163, 1035187, 1035191, 1035197, 1035211, 1035241, 1035247, 1035257, 1035263, 1035277, 1035301, 1035313, 1035323, 1035341, 1035343, 1035361, 1035379, 1035383, 1035403, 1035409, 1035413, 1035427, 1035449, 1035451, 1035467, 1035469, 1035473, 1035479, 1035499, 1035527, 1035533, 1035547, 1035563, 1035571, 1035581, 1035599, 1035607, 1035613, 1035631, 1035637, 1035641, 1035649, 1035659, 1035707, 1035733, 1035743, 1035761, 1035763, 1035781, 1035791, 1035829, 1035869, 1035893, 1035917, 1035949, 1035953, 1035959, 1035973, 1035977, 1036001, 1036003, 1036027, 1036039, 1036067, 1036069, 1036073, 1036093, 1036109, 1036117, 1036121, 1036129, 1036153, 1036163, 1036183, 1036213, 1036223, 1036229, 1036247, 1036249, 1036253, 1036261, 1036267, 1036271, 1036291, 1036297, 1036307, 1036319, 1036327, 1036331, 1036339, 1036349, 1036351, 1036363, 1036367, 1036369, 1036391, 1036411, 1036459, 1036471, 1036493, 1036499, 1036513, 1036531, 1036537, 1036561, 1036579, 1036613, 1036619, 1036631, 1036649, 1036661, 1036667, 1036669, 1036681, 1036729, 1036747, 1036751, 1036757, 1036759, 1036769, 1036787, 1036793, 1036799, 1036829, 1036831, 1036853, 1036873, 1036877, 1036883, 1036913, 1036921, 1036943, 1036951, 1036957, 1036979, 1036991, 1036993, 1037041, 1037053, 1037059, 1037081, 1037087, 1037089, 1037123, 1037129, 1037137, 1037143, 1037213, 1037233, 1037249, 1037261, 1037273, 1037293, 1037297, 1037303, 1037317, 1037327, 1037329, 1037339, 1037347, 1037401, 1037411, 1037437, 1037441, 1037447, 1037471, 1037479, 1037489, 1037497, 1037503, 1037537, 1037557, 1037563, 1037567, 1037593, 1037611, 1037627, 1037653, 1037657, 1037677, 1037681, 1037683, 1037741, 1037747, 1037753, 1037759, 1037767, 1037791, 1037801, 1037819, 1037831, 1037857, 1037873, 1037879, 1037893, 1037903, 1037917, 1037929, 1037941, 1037957, 1037963, 1037983, 1038001, 1038017, 1038019, 1038029, 1038041, 1038043, 1038047, 1038073, 1038077, 1038119, 1038127, 1038143, 1038157, 1038187, 1038199, 1038203, 1038209, 1038211, 1038227, 1038251, 1038253, 1038259, 1038263, 1038269, 1038307, 1038311, 1038319, 1038329, 1038337, 1038383, 1038391, 1038409, 1038421, 1038449, 1038463, 1038487, 1038497, 1038503, 1038523, 1038529, 1038539, 1038563, 1038589, 1038599, 1038601, 1038617, 1038619, 1038623, 1038629, 1038637, 1038643, 1038671, 1038689, 1038691, 1038707, 1038721, 1038727, 1038731, 1038757, 1038797, 1038803, 1038811, 1038823, 1038827, 1038833, 1038881, 1038913, 1038937, 1038941, 1038953, 1039001, 1039007, 1039021, 1039033, 1039037, 1039039, 1039043, 1039067, 1039069, 1039081, 1039109, 1039111, 1039127, 1039139, 1039153, 1039169, 1039187, 1039229, 1039249, 1039279, 1039289, 1039307, 1039321, 1039327, 1039343, 1039349, 1039351, 1039387, 1039421, 1039427, 1039429, 1039463, 1039469, 1039477, 1039481, 1039513, 1039517, 1039537, 1039543, 1039553, 1039603, 1039607, 1039631, 1039651, 1039657, 1039667, 1039681, 1039733, 1039763, 1039769, 1039789, 1039799, 1039817, 1039823, 1039837, 1039891, 1039897, 1039901, 1039921, 1039931, 1039943, 1039949, 1039979, 1039999, 1040021, 1040029, 1040051, 1040057, 1040059, 1040069, 1040071, 1040089, 1040093, 1040101, 1040113, 1040119, 1040141, 1040153, 1040159, 1040161, 1040167, 1040183, 1040189, 1040191, 1040203, 1040219, 1040227, 1040311, 1040327, 1040339, 1040353, 1040371, 1040381, 1040387, 1040407, 1040411, 1040419, 1040447, 1040449, 1040483, 1040489, 1040503, 1040521, 1040531, 1040563, 1040579, 1040581, 1040597, 1040629, 1040651, 1040657, 1040659, 1040671, 1040717, 1040731, 1040747, 1040749, 1040771, 1040777, 1040779, 1040783, 1040797, 1040803, 1040807, 1040813, 1040821, 1040827, 1040833, 1040857, 1040861, 1040873, 1040881, 1040891, 1040899, 1040929, 1040939, 1040947, 1040951, 1040959, 1040981, 1040989, 1041041, 1041077, 1041083, 1041091, 1041109, 1041119, 1041121, 1041127, 1041137, 1041149, 1041151, 1041163, 1041167, 1041169, 1041203, 1041221, 1041223, 1041239, 1041241, 1041253, 1041269, 1041281, 1041283, 1041289, 1041307, 1041311, 1041317, 1041329, 1041343, 1041349, 1041373, 1041421, 1041427, 1041449, 1041451, 1041461, 1041497, 1041511, 1041517, 1041529, 1041553, 1041559, 1041563, 1041571, 1041577, 1041583, 1041617, 1041619, 1041643, 1041653, 1041671, 1041673, 1041701, 1041731, 1041737, 1041757, 1041779, 1041787, 1041793, 1041823, 1041829, 1041841, 1041853, 1041857, 1041863, 1041869, 1041889, 1041893, 1041907, 1041919, 1041949, 1041961, 1041983, 1041991, 1042001, 1042021, 1042039, 1042043, 1042081, 1042087, 1042091, 1042099, 1042103, 1042109, 1042121, 1042123, 1042133, 1042141, 1042183, 1042187, 1042193, 1042211, 1042241, 1042243, 1042259, 1042267, 1042271, 1042273, 1042309, 1042331, 1042333, 1042357, 1042369, 1042373, 1042381, 1042399, 1042427, 1042439, 1042451, 1042469, 1042487, 1042519, 1042523, 1042529, 1042571, 1042577, 1042583, 1042597, 1042607, 1042609, 1042619, 1042631, 1042633, 1042681, 1042687, 1042693, 1042703, 1042709, 1042733, 1042759, 1042781, 1042799, 1042819, 1042829, 1042837, 1042849, 1042861, 1042897, 1042901, 1042903, 1042931, 1042949, 1042961, 1042997, 1043011, 1043023, 1043047, 1043083, 1043089, 1043111, 1043113, 1043117, 1043131, 1043167, 1043173, 1043177, 1043183, 1043191, 1043201, 1043209, 1043213, 1043221, 1043279, 1043291, 1043293, 1043299, 1043311, 1043323, 1043351, 1043369, 1043377, 1043401, 1043453, 1043467, 1043479, 1043489, 1043501, 1043513, 1043521, 1043531, 1043543, 1043557, 1043587, 1043591, 1043593, 1043597, 1043599, 1043617, 1043639, 1043657, 1043663, 1043683, 1043701, 1043723, 1043743, 1043747, 1043753, 1043759, 1043761, 1043767, 1043773, 1043831, 1043837, 1043839, 1043843, 1043849, 1043857, 1043869, 1043873, 1043897, 1043899, 1043921, 1043923, 1043929, 1043951, 1043969, 1043981, 1044019, 1044023, 1044041, 1044053, 1044079, 1044091, 1044097, 1044133, 1044139, 1044149, 1044161, 1044167, 1044179, 1044181, 1044187, 1044193, 1044209, 1044217, 1044227, 1044247, 1044257, 1044271, 1044283, 1044287, 1044289, 1044299, 1044343, 1044347, 1044353, 1044367, 1044371, 1044383, 1044391, 1044397, 1044409, 1044437, 1044443, 1044451, 1044457, 1044479, 1044509, 1044517, 1044529, 1044559, 1044569, 1044583, 1044587, 1044613, 1044619, 1044629, 1044653, 1044689, 1044697, 1044727, 1044733, 1044737, 1044739, 1044749, 1044751, 1044761, 1044767, 1044779, 1044781, 1044809, 1044811, 1044833, 1044839, 1044847, 1044851, 1044859, 1044877, 1044889, 1044893, 1044931, 1044941, 1044971, 1044997, 1045003, 1045013, 1045021, 1045027, 1045043, 1045061, 1045063, 1045081, 1045111, 1045117, 1045123, 1045129, 1045151, 1045153, 1045157, 1045183, 1045193, 1045199, 1045223, 1045229, 1045237, 1045241, 1045273, 1045277, 1045307, 1045309, 1045321, 1045349, 1045367, 1045391, 1045393, 1045397, 1045409, 1045411, 1045423, 1045427, 1045469, 1045487, 1045493, 1045507, 1045523, 1045529, 1045543, 1045547, 1045549, 1045559, 1045571, 1045573, 1045607, 1045621, 1045633, 1045643, 1045651, 1045663, 1045679, 1045691, 1045727, 1045729, 1045739, 1045763, 1045799, 1045801, 1045819, 1045829, 1045841, 1045859, 1045903, 1045907, 1045963, 1045981, 1045987, 1045997, 1046029, 1046047, 1046051, 1046053, 1046069, 1046077, 1046081, 1046113, 1046119, 1046179, 1046183, 1046189, 1046191, 1046203, 1046207, 1046237, 1046239, 1046257, 1046263, 1046329, 1046347, 1046351, 1046369, 1046371, 1046389, 1046393, 1046399, 1046413, 1046447, 1046449, 1046459, 1046497, 1046519, 1046527, 1046557, 1046579, 1046587, 1046597, 1046599, 1046627, 1046641, 1046657, 1046659, 1046677, 1046681, 1046687, 1046701, 1046711, 1046779, 1046791, 1046797, 1046807, 1046827, 1046833, 1046849, 1046863, 1046867, 1046897, 1046917, 1046933, 1046951, 1046959, 1046977, 1046993, 1046999, 1047031, 1047041, 1047043, 1047061, 1047077, 1047089, 1047097, 1047107, 1047119, 1047127, 1047131, 1047133, 1047139, 1047157, 1047173, 1047197, 1047199, 1047229, 1047239, 1047247, 1047271, 1047281, 1047283, 1047289, 1047307, 1047311, 1047313, 1047317, 1047323, 1047341, 1047367, 1047373, 1047379, 1047391, 1047419, 1047467, 1047469, 1047479, 1047491, 1047499, 1047511, 1047533, 1047539, 1047551, 1047559, 1047587, 1047589, 1047647, 1047649, 1047653, 1047667, 1047671, 1047689, 1047691, 1047701, 1047703, 1047713, 1047721, 1047737, 1047751, 1047763, 1047773, 1047779, 1047821, 1047833, 1047841, 1047859, 1047881, 1047883, 1047887, 1047923, 1047929, 1047941, 1047961, 1047971, 1047979, 1047989, 1047997, 1048007, 1048009, 1048013, 1048027, 1048043, 1048049, 1048051, 1048063, 1048123, 1048127, 1048129, 1048139, 1048189, 1048193, 1048213, 1048217, 1048219, 1048261, 1048273, 1048291, 1048309, 1048343, 1048357, 1048361, 1048367, 1048387, 1048391, 1048423, 1048433, 1048447, 1048507, 1048517, 1048549, 1048559, 1048571, 1048573),
                        false
                )
        );
    }

    @ParameterizedTest
    @MethodSource("testsProvider")
    void test(List<Integer> list, boolean answer) {
        var threadSolTime = threadSol(list, answer);
        assertThat(threadSolTime).isNotNull();
        for (var i = 0; i < MAX_THREADS; ++i) {
            threadSolAvgTime.set(i, threadSolAvgTime.get(i) + timeToAvgFraction(threadSolTime.get(i)));
        }

        sequentialSolAvgTime += timeToAvgFraction(sequentialSol(list, answer));
        threadSolTotalAvgTime += timeToAvgFraction(max(threadSolTime));
        parallelStreamSolAvgTime += timeToAvgFraction(parallelStreamSol(list, answer));
    }
}
